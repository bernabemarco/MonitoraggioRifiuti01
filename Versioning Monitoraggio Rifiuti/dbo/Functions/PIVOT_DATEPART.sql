
CREATE FUNCTION PIVOT_DATEPART(@DATA DATETIME, @PART VARCHAR(1))
RETURNS TABLE
AS
RETURN SELECT CASE 
    WHEN @PART = 'W' THEN DATEPART(ww, @DATA)
    WHEN @PART = 'M' THEN MONTH(@DATA)
    WHEN @PART = 'T' THEN DATEPART(q, @DATA) 
    WHEN @PART = 'S' THEN (CASE WHEN MONTH(@DATA)<=6 THEN 1 ELSE 2 END)
END AS DTPART

GO
GRANT SELECT
    ON OBJECT::[dbo].[PIVOT_DATEPART] TO [Metodo98]
    AS [dbo];

