
CREATE VIEW VISTASCADENZE_EXPORT AS
SELECT PROGRESSIVO, ESERCIZIO, ANNODOC, TIPODOC, NUMDOC, BIS, NUMSCAD,
       DATASCADENZA, CODCLIFOR, DATAFATTURA, BANCAINC, BANCAAPPOGGIO, NUMRIF,
       NUMEROPROT, CODAGE1, CODAGE2, CODAGE3, IMPPROVLIT1, IMPPROVLIT2,
       IMPPROVLIT3, IMPPROVVAL1, IMPPROVVAL2, IMPPROVVAL3, IMPPROVEURO1,
       IMPPROVEURO2, IMPPROVEURO3, LIQPROV1, LIQPROV2, LIQPROV3, IMPORTOSCLIT,
       IMPORTOSCVAL, IMPORTOSCEURO, IMPONIBSCLIT, IMPONIBSCVAL, IMPONIBSCEURO,
       TOTFATTLIT, TOTFATTVAL, TOTFATTEURO, IMPFATTLIT, IMPFATTVAL, IMPFATTEURO,
       FLAGCONT, TIPOEFFETTO, ESITO, LIVSOLL, LIQINS1, LIQINS2, LIQINS3, CODCAMBIO,
       VALCAMBIO, NRDISTINTA, NUMRAGGR, DATAPAGEFF, SCADATTPASS, NUMRIFPARTCONT,
       CODPAG, DATADEC, NOTE, NRGIORNALE, UTENTEMODIFICA, DATAMODIFICA, RIFRIGACONT,
       ESITOPREC, NRREGESITO, IDBOZZAAGT1, NRRIGAAGT1, IDBOZZAAGT2, NRRIGAAGT2, IDBOZZAAGT3,
       NRRIGAAGT3, DATASOLL1, DATASOLL2, DATASOLL3, RIFSCADRIEMISSIONE, FLAGCESSIONE, ABI_RIEMISS,
       CAB_RIEMISS, RAGSOC_RIEMISS, INDIRIZZO_RIEMISS, CAP_RIEMISS, LOCALITA_RIEMISS, PROV_RIEMISS,
       NAZ_RIEMISS, NOTE_RIEMISS, ESITOPRECRIEMISS, DSCBANCARIEMISS, DATAULTCALCINT
FROM TABSCADENZE
WHERE TIPODOC='___'
UNION
SELECT TS.PROGRESSIVO, TS.ESERCIZIO, TS.ANNODOC, '___', TC.PROGRESSIVO, '', TS.NUMSCAD,
       TS.DATASCADENZA, TS.CODCLIFOR, TS.DATAFATTURA, TS.BANCAINC, TS.BANCAAPPOGGIO, TS.NUMRIF,
       TS.NUMEROPROT, TS.CODAGE1, TS.CODAGE2, TS.CODAGE3, TS.IMPPROVLIT1, TS.IMPPROVLIT2,
       TS.IMPPROVLIT3, TS.IMPPROVVAL1, TS.IMPPROVVAL2, TS.IMPPROVVAL3, TS.IMPPROVEURO1,
       TS.IMPPROVEURO2, TS.IMPPROVEURO3, TS.LIQPROV1, TS.LIQPROV2, TS.LIQPROV3, TS.IMPORTOSCLIT,
       TS.IMPORTOSCVAL, TS.IMPORTOSCEURO, TS.IMPONIBSCLIT, TS.IMPONIBSCVAL, TS.IMPONIBSCEURO,
       TS.TOTFATTLIT, TS.TOTFATTVAL, TS.TOTFATTEURO, TS.IMPFATTLIT, TS.IMPFATTVAL, TS.IMPFATTEURO,
       TS.FLAGCONT, TS.TIPOEFFETTO, TS.ESITO, TS.LIVSOLL, TS.LIQINS1, TS.LIQINS2, TS.LIQINS3, TS.CODCAMBIO,
       TS.VALCAMBIO, TS.NRDISTINTA, TS.NUMRAGGR, TS.DATAPAGEFF, TS.SCADATTPASS, TS.NUMRIFPARTCONT,
       TS.CODPAG, TS.DATADEC, TS.NOTE, TS.NRGIORNALE, TS.UTENTEMODIFICA, TS.DATAMODIFICA, TS.RIFRIGACONT,
       TS.ESITOPREC, TS.NRREGESITO, TS.IDBOZZAAGT1, TS.NRRIGAAGT1, TS.IDBOZZAAGT2, TS.NRRIGAAGT2, TS.IDBOZZAAGT3,
       TS.NRRIGAAGT3, TS.DATASOLL1, TS.DATASOLL2, TS.DATASOLL3, TS.RIFSCADRIEMISSIONE, TS.FLAGCESSIONE, TS.ABI_RIEMISS,
       TS.CAB_RIEMISS, TS.RAGSOC_RIEMISS, TS.INDIRIZZO_RIEMISS, TS.CAP_RIEMISS, TS.LOCALITA_RIEMISS, TS.PROV_RIEMISS,
       TS.NAZ_RIEMISS, TS.NOTE_RIEMISS, TS.ESITOPRECRIEMISS, TS.DSCBANCARIEMISS, TS.DATAULTCALCINT
  FROM TABSCADENZE TS
       INNER JOIN TESTEDOCUMENTI TD ON TD.ESERCIZIO=TS.ANNODOC AND TD.TIPODOC=TS.TIPODOC AND TD.NUMERODOC=TS.NUMDOC AND TD.BIS=TS.BIS
       INNER JOIN TESTECONTABILITA TC ON TC.IDTESTADOC=TD.PROGRESSIVO
WHERE TS.TIPODOC<>'___'
GO
GRANT SELECT
    ON OBJECT::[dbo].[VISTASCADENZE_EXPORT] TO [Metodo98]
    AS [dbo];

