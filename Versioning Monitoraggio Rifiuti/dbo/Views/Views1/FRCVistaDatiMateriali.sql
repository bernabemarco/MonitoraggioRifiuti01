
CREATE VIEW FRCVistaDatiMateriali AS 
	SELECT ID, AMBIENTE AS Ambiente, ISNULL((SELECT DESCRIZIONE FROM CGesAmbienti WHERE Codice = FRCDatiMateriali.AMBIENTE), '') AS Descrizione_Ambiente, ANNO AS Anno, 
		   NomeEsplosione AS Nome_Esplosione, MESEDOC AS Mese, COMPOSTO AS Composto, DSCCOMPOSTO AS Descrizione_Composto, UMGEST AS UM_Gestione, QTAGEST AS [Quantita'_Gestione], 
		   UMPREZZO AS UM_Prezzo, QTAPREZZO AS [Quantita'_Prezzo], FATTORE AS Fattore_Conversione, QUANTITA AS [Quantita'], 
		   CDRMercato AS CDR_Mercato, ISNULL((SELECT DESCRIZIONE FROM TABCENTRICOSTO WHERE CODICE = FRCDatiMateriali.CDRMercato), '') AS Descrizione_CDR_Mercato, 
		   CDRProdotto AS CDR_Prodotto, ISNULL((SELECT DESCRIZIONE FROM TABCENTRICOSTO WHERE CODICE = FRCDatiMateriali.CDRProdotto), '') AS Descrizione_CDR_Prodotto, 
		   CONTOACQITA AS Conto_ITA, ISNULL((SELECT DSCCONTO1 FROM ANAGRAFICAGENERICI WHERE CODCONTO = FRCDatiMateriali.CONTOACQITA), '') AS Descrizione_Conto_ITA, 
		   CDCACQITA AS Centro_ITA, ISNULL((SELECT DESCRIZIONE FROM TABCENTRICOSTO WHERE CODICE = FRCDatiMateriali.CDCACQITA), '') AS Descrizione_Centro_ITA, 
		   CONTOACQEST AS Conto_EST, ISNULL((SELECT DSCCONTO1 FROM ANAGRAFICAGENERICI WHERE CODCONTO = FRCDatiMateriali.CONTOACQEST), '') AS Descrizione_Conto_EST, 
		   CDCACQEST AS Centro_EST, ISNULL((SELECT DESCRIZIONE FROM TABCENTRICOSTO WHERE CODICE = FRCDatiMateriali.CDCACQEST), '') AS Descrizione_Centro_EST, 
		   COSTOUNIEURODIBAITA AS Costo_Unitario_DiBa_ITA, COSTOTOTEURODIBAITA AS Costo_Totale_DiBa_ITA, 
		   COSTOUNIEURODIBAEST AS Costo_Unitario_DiBa_EST, COSTOTOTEURODIBAEST AS Costo_Totale_DiBa_EST, 
		   COSTOUNIEURODIBA AS Costo_Unitario_DiBa, COSTOTOTEURODIBA AS Costo_Totale_DiBa, 
		   COSTOUNIEURODIBAITARESA AS Costo_Unitario_DiBa_ITA_Resa, COSTOTOTEURODIBAITARESA AS Costo_Totale_DiBa_ITA_Resa, 
		   COSTOUNIEURODIBAESTRESA AS Costo_Unitario_DiBa_EST_Resa, COSTOTOTEURODIBAESTRESA AS Costo_Totale_DiBa_EST_Resa, 
		   COSTOUNIEURODIBARESA AS Costo_Unitario_DiBa_Resa, COSTOTOTEURODIBARESA AS Costo_Totale_DiBa_Resa
	FROM FRCDatiMateriali

GO
GRANT SELECT
    ON OBJECT::[dbo].[FRCVistaDatiMateriali] TO [Metodo98]
    AS [dbo];

