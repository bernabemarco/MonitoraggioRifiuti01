CREATE VIEW VISTALISTAMPP
AS
SELECT DISTINCT
	RMPP.RIFPROGRESSIVO, 
	TMPS.ESERCIZIO, 
	TMPS.CODICE, 
	TMPS.NUMERO, 
	TMPS.RIFERIMENTO, 
	TMPS.NUMEROFOGLIO, 
	TMPS.DATAEMISSIONE, 
	TMPS.FLGPRINCIPALE, 
	RMPP.ARTICOLOMPS, 
	ARTMPS.DESCRIZIONE AS DESCRIZIONEARTICOLOMPS,
	RMPP.ARTICOLO, 
	ARTMPP.DESCRIZIONE AS DESCRIZIONEARTICOLO
FROM
	RIGHEMPP AS RMPP
	INNER JOIN
	TESTAMPS AS TMPS
	ON RMPP.RIFPROGRESSIVO = TMPS.PROGRESSIVO
	INNER JOIN
	ANAGRAFICAARTICOLI AS ARTMPS
	ON RMPP.ARTICOLOMPS = ARTMPS.CODICE
	INNER JOIN
	ANAGRAFICAARTICOLI AS ARTMPP
	ON RMPP.ARTICOLO = ARTMPP.CODICE

GO
GRANT SELECT
    ON OBJECT::[dbo].[VISTALISTAMPP] TO [Metodo98]
    AS [dbo];

