

CREATE VIEW TP_VISTASCTLOGGRP
AS
SELECT     TP_TESTE_SCONTI_LOGISTICI.PROGRESSIVO, TP_TESTE_SCONTI_LOGISTICI.DADATA, TP_TESTE_SCONTI_LOGISTICI.ADATA, 
                      TP_TESTE_SCONTI_LOGISTICI.CODCLIFOR, TP_TESTE_SCONTI_LOGISTICI.TIPOLOGIADETTAGLIO,TP_TESTE_SCONTI_LOGISTICI.TIPOLOGIASCONTO,
                      TP_TESTE_SCONTI_LOGISTICI.TIPO_TOTALE,TP_TESTE_SCONTI_LOGISTICI.RifContratto, 
                      ANAGRAFICAARTICOLI.CODICE, 
                      TP_RIGHE_SCONTI_LOGISTICI_GRUPPO.UM, TP_RIGHE_SCONTI_LOGISTICI_GRUPPO.QTAMIN, 
                      TP_RIGHE_SCONTI_LOGISTICI_GRUPPO.SCONTO
FROM         TP_TESTE_SCONTI_LOGISTICI INNER JOIN
                      TP_RIGHE_SCONTI_LOGISTICI_GRUPPO ON 
                      TP_TESTE_SCONTI_LOGISTICI.PROGRESSIVO = TP_RIGHE_SCONTI_LOGISTICI_GRUPPO.RIFPROGRESSIVO INNER JOIN
                      ANAGRAFICAARTICOLI ON dbo.TP_RIGHE_SCONTI_LOGISTICI_GRUPPO.GRUPPO = ANAGRAFICAARTICOLI.GRUPPO
WHERE     (TP_TESTE_SCONTI_LOGISTICI.TIPOLOGIADETTAGLIO = 0) AND (ANAGRAFICAARTICOLI.GRUPPO <> 0)


GO
GRANT SELECT
    ON OBJECT::[dbo].[TP_VISTASCTLOGGRP] TO [Metodo98]
    AS [dbo];

