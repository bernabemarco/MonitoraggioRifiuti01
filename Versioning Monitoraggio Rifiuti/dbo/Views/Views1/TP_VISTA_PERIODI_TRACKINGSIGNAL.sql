

Create view [dbo].[TP_VISTA_PERIODI_TRACKINGSIGNAL] 
as

SELECT
    DATO1.CodArticolo,
    DATO1.CodDeposito,
    DATO1.Tipo,
    CASE WHEN [V1] > 0 THEN [1] / (([A1]) / 1) ELSE 0 END AS [-1],
    CASE WHEN [V2] > 0 THEN [2] / (([A2]) / 2) ELSE 0 END AS [-2],
    CASE WHEN [V3] > 0 THEN [3] / (([A3]) / 3) ELSE 0 END AS [-3],
    CASE WHEN [V4] > 0 THEN [4] / (([A4]) / 4) ELSE 0 END AS [-4],
    CASE WHEN [V5] > 0 THEN [5] / (([A5]) / 5) ELSE 0 END AS [-5],
    CASE WHEN [V6] > 0 THEN [6] / (([A6]) / 6) ELSE 0 END AS [-6],
    CASE WHEN [V7] > 0 THEN [7] / (([A7]) / 7) ELSE 0 END AS [-7],
    CASE WHEN [V8] > 0 THEN [8] / (([A8]) / 8) ELSE 0 END AS [-8],
    CASE WHEN [V9] > 0 THEN [9] / (([A9]) / 9) ELSE 0 END AS [-9],
    CASE WHEN [V10] > 0 THEN [10] / (([A10]) / 10) ELSE 0 END AS [-10],
    CASE WHEN [V11] > 0 THEN [11] / (([A11]) / 11) ELSE 0 END AS [-11],
    CASE WHEN [V12] > 0 THEN [12] / (([A12]) / 12) ELSE 0 END AS [-12],
    CASE WHEN [V13] > 0 THEN [13] / (([A13]) / 13) ELSE 0 END AS [-13],
    CASE WHEN [V14] > 0 THEN [14] / (([A14]) / 14) ELSE 0 END AS [-14],
    CASE WHEN [V15] > 0 THEN [15] / (([A15]) / 15) ELSE 0 END AS [-15],
    CASE WHEN [V16] > 0 THEN [16] / (([A16]) / 16) ELSE 0 END AS [-16],
    CASE WHEN [V17] > 0 THEN [17] / (([A17]) / 17) ELSE 0 END AS [-17],
    CASE WHEN [V18] > 0 THEN [18] / (([A18]) / 18) ELSE 0 END AS [-18],
    CASE WHEN [V19] > 0 THEN [19] / (([A19]) / 19) ELSE 0 END AS [-19],
    CASE WHEN [V20] > 0 THEN [20] / (([A20]) / 20) ELSE 0 END AS [-20],
    CASE WHEN [V21] > 0 THEN [21] / (([A21]) / 21) ELSE 0 END AS [-21],
    CASE WHEN [V22] > 0 THEN [22] / (([A22]) / 22) ELSE 0 END AS [-22],
    CASE WHEN [V23] > 0 THEN [23] / (([A23]) / 23) ELSE 0 END AS [-23],
    CASE WHEN [V24] > 0 THEN [24] / (([A24]) / 24) ELSE 0 END AS [-24],
    CASE WHEN [V25] > 0 THEN [25] / (([A25]) / 25) ELSE 0 END AS [-25],
    CASE WHEN [V26] > 0 THEN [26] / (([A26]) / 26) ELSE 0 END AS [-26],
    CASE WHEN [V27] > 0 THEN [27] / (([A27]) / 27) ELSE 0 END AS [-27],
    CASE WHEN [V28] > 0 THEN [28] / (([A28]) / 28) ELSE 0 END AS [-28],
    CASE WHEN [V29] > 0 THEN [29] / (([A29]) / 29) ELSE 0 END AS [-29],
    CASE WHEN [V30] > 0 THEN [30] / (([A30]) / 30) ELSE 0 END AS [-30],
    CASE WHEN [V31] > 0 THEN [31] / (([A31]) / 31) ELSE 0 END AS [-31],
    CASE WHEN [V32] > 0 THEN [32] / (([A32]) / 32) ELSE 0 END AS [-32],
    CASE WHEN [V33] > 0 THEN [33] / (([A33]) / 33) ELSE 0 END AS [-33],
    CASE WHEN [V34] > 0 THEN [34] / (([A34]) / 34) ELSE 0 END AS [-34],
    CASE WHEN [V35] > 0 THEN [35] / (([A35]) / 35) ELSE 0 END AS [-35]
FROM
(
    SELECT
        BASE.CodArticolo,
        BASE.CodDeposito,
        BASE.Tipo,
        ([1]) AS [1],
        ([1]+[2]) AS [2],
        ([1]+[2]+[3]) AS [3],
        ([1]+[2]+[3]+[4]) AS [4],
        ([1]+[2]+[3]+[4]+[5]) AS [5],
        ([1]+[2]+[3]+[4]+[5]+[6]) AS [6],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]) AS [7],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]) AS [8],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]) AS [9],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]) AS [10],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]) AS [11],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]) AS [12],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]) AS [13],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]) AS [14],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]) AS [15],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]) AS [16],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]) AS [17],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]) AS [18],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]) AS [19],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]) AS [20],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]) AS [21],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]+[22]) AS [22],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]+[22]+[23]) AS [23],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]+[22]+[23]+[24]) AS [24],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]+[22]+[23]+[24]+[25]) AS [25],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]+[22]+[23]+[24]+[25]+[26]) AS [26],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]+[22]+[23]+[24]+[25]+[26]+[27]) AS [27],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]+[22]+[23]+[24]+[25]+[26]+[27]+[28]) AS [28],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]+[22]+[23]+[24]+[25]+[26]+[27]+[28]+[29]) AS [29],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]+[22]+[23]+[24]+[25]+[26]+[27]+[28]+[29]+[30]) AS [30],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]+[22]+[23]+[24]+[25]+[26]+[27]+[28]+[29]+[30]+[31]) AS [31],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]+[22]+[23]+[24]+[25]+[26]+[27]+[28]+[29]+[30]+[31]+[32]) AS [32],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]+[22]+[23]+[24]+[25]+[26]+[27]+[28]+[29]+[30]+[31]+[32]+[33]) AS [33],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]+[22]+[23]+[24]+[25]+[26]+[27]+[28]+[29]+[30]+[31]+[32]+[33]+[34]) AS [34],
        ([1]+[2]+[3]+[4]+[5]+[6]+[7]+[8]+[9]+[10]+[11]+[12]+[13]+[14]+[15]+[16]+[17]+[18]+[19]+[20]+[21]+[22]+[23]+[24]+[25]+[26]+[27]+[28]+[29]+[30]+[31]+[32]+[33]+[34]+[35]) AS [35],
        ISNULL(NULLIF(([A1]),0),1) AS [A1],
        ISNULL(NULLIF(([A1]+[A2]),0),1) AS [A2],
        ISNULL(NULLIF(([A1]+[A2]+[A3]),0),1) AS [A3],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]),0),1) AS [A4],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]),0),1) AS [A5],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]),0),1) AS [A6],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]),0),1) AS [A7],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]),0),1) AS [A8],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]),0),1) AS [A9],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]),0),1) AS [A10],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]),0),1) AS [A11],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]),0),1) AS [A12],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]),0),1) AS [A13],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]),0),1) AS [A14],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]),0),1) AS [A15],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]),0),1) AS [A16],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]),0),1) AS [A17],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]),0),1) AS [A18],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]),0),1) AS [A19],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]),0),1) AS [A20],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]),0),1) AS [A21],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]+[A22]),0),1) AS [A22],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]+[A22]+[A23]),0),1) AS [A23],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]+[A22]+[A23]+[A24]),0),1) AS [A24],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]+[A22]+[A23]+[A24]+[A25]),0),1) AS [A25],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]+[A22]+[A23]+[A24]+[A25]+[A26]),0),1) AS [A26],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]+[A22]+[A23]+[A24]+[A25]+[A26]+[A27]),0),1) AS [A27],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]+[A22]+[A23]+[A24]+[A25]+[A26]+[A27]+[A28]),0),1) AS [A28],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]+[A22]+[A23]+[A24]+[A25]+[A26]+[A27]+[A28]+[A29]),0),1) AS [A29],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]+[A22]+[A23]+[A24]+[A25]+[A26]+[A27]+[A28]+[A29]+[A30]),0),1) AS [A30],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]+[A22]+[A23]+[A24]+[A25]+[A26]+[A27]+[A28]+[A29]+[A30]+[A31]),0),1) AS [A31],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]+[A22]+[A23]+[A24]+[A25]+[A26]+[A27]+[A28]+[A29]+[A30]+[A31]+[A32]),0),1) AS [A32],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]+[A22]+[A23]+[A24]+[A25]+[A26]+[A27]+[A28]+[A29]+[A30]+[A31]+[A32]+[A33]),0),1) AS [A33],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]+[A22]+[A23]+[A24]+[A25]+[A26]+[A27]+[A28]+[A29]+[A30]+[A31]+[A32]+[A33]+[A34]),0),1) AS [A34],
        ISNULL(NULLIF(([A1]+[A2]+[A3]+[A4]+[A5]+[A6]+[A7]+[A8]+[A9]+[A10]+[A11]+[A12]+[A13]+[A14]+[A15]+[A16]+[A17]+[A18]+[A19]+[A20]+[A21]+[A22]+[A23]+[A24]+[A25]+[A26]+[A27]+[A28]+[A29]+[A30]+[A31]+[A32]+[A33]+[A34]+[A35]),0),1) AS [A35],
        [V1],
        [V2],
        [V3],
        [V4],
        [V5],
        [V6],
        [V7],
        [V8],
        [V9],
        [V10],
        [V11],
        [V12],
        [V13],
        [V14],
        [V15],
        [V16],
        [V17],
        [V18],
        [V19],
        [V20],
        [V21],
        [V22],
        [V23],
        [V24],
        [V25],
        [V26],
        [V27],
        [V28],
        [V29],
        [V30],
        [V31],
        [V32],
        [V33],
        [V34],
        [V35],
        [V36]
    FROM
    (
        SELECT 
            p.CodArticolo,
            p.CodDeposito,
            p.Tipo,
            (p.[2] - v.[1]) as [1],
            (p.[3] - v.[2]) as [2],
            (p.[4] - v.[3]) as [3],
            (p.[5] - v.[4]) as [4],
            (p.[6] - v.[5]) as [5],
            (p.[7] - v.[6]) as [6],
            (p.[8] - v.[7]) as [7],
            (p.[9] - v.[8]) as [8],
            (p.[10] - v.[9]) as [9],
            (p.[11] - v.[10]) as [10],
            (p.[12] - v.[11]) as [11],
            (p.[13] - v.[12]) as [12],
            (p.[14] - v.[13]) as [13],
            (p.[15] - v.[14]) as [14],
            (p.[16] - v.[15]) as [15],
            (p.[17] - v.[16]) as [16],
            (p.[18] - v.[17]) as [17],
            (p.[19] - v.[18]) as [18],
            (p.[20] - v.[19]) as [19],
            (p.[21] - v.[20]) as [20],
            (p.[22] - v.[21]) as [21],
            (p.[23] - v.[22]) as [22],
            (p.[24] - v.[23]) as [23],
            (p.[25] - v.[24]) as [24],
            (p.[26] - v.[25]) as [25],
            (p.[27] - v.[26]) as [26],
            (p.[28] - v.[27]) as [27],
            (p.[29] - v.[28]) as [28],
            (p.[30] - v.[29]) as [29],
            (p.[31] - v.[30]) as [30],
            (p.[32] - v.[31]) as [31],
            (p.[33] - v.[32]) as [32],
            (p.[34] - v.[33]) as [33],
            (p.[35] - v.[34]) as [34],
            (p.[36] - v.[35]) as [35],
            ABS(p.[2] - v.[1]) as [A1],
            ABS(p.[3] - v.[2]) as [A2],
            ABS(p.[4] - v.[3]) as [A3],
            ABS(p.[5] - v.[4]) as [A4],
            ABS(p.[6] - v.[5]) as [A5],
            ABS(p.[7] - v.[6]) as [A6],
            ABS(p.[8] - v.[7]) as [A7],
            ABS(p.[9] - v.[8]) as [A8],
            ABS(p.[10] - v.[9]) as [A9],
            ABS(p.[11] - v.[10]) as [A10],
            ABS(p.[12] - v.[11]) as [A11],
            ABS(p.[13] - v.[12]) as [A12],
            ABS(p.[14] - v.[13]) as [A13],
            ABS(p.[15] - v.[14]) as [A14],
            ABS(p.[16] - v.[15]) as [A15],
            ABS(p.[17] - v.[16]) as [A16],
            ABS(p.[18] - v.[17]) as [A17],
            ABS(p.[19] - v.[18]) as [A18],
            ABS(p.[20] - v.[19]) as [A19],
            ABS(p.[21] - v.[20]) as [A20],
            ABS(p.[22] - v.[21]) as [A21],
            ABS(p.[23] - v.[22]) as [A22],
            ABS(p.[24] - v.[23]) as [A23],
            ABS(p.[25] - v.[24]) as [A24],
            ABS(p.[26] - v.[25]) as [A25],
            ABS(p.[27] - v.[26]) as [A26],
            ABS(p.[28] - v.[27]) as [A27],
            ABS(p.[29] - v.[28]) as [A28],
            ABS(p.[30] - v.[29]) as [A29],
            ABS(p.[31] - v.[30]) as [A30],
            ABS(p.[32] - v.[31]) as [A31],
            ABS(p.[33] - v.[32]) as [A32],
            ABS(p.[34] - v.[33]) as [A33],
            ABS(p.[35] - v.[34]) as [A34],
            ABS(p.[36] - v.[35]) as [A35],
            v.[1] AS [V1],
            v.[2] AS [V2],
            v.[3] AS [V3],
            v.[4] AS [V4],
            v.[5] AS [V5],
            v.[6] AS [V6],
            v.[7] AS [V7],
            v.[8] AS [V8],
            v.[9] AS [V9],
            v.[10] AS [V10],
            v.[11] AS [V11],
            v.[12] AS [V12],
            v.[13] AS [V13],
            v.[14] AS [V14],
            v.[15] AS [V15],
            v.[16] AS [V16],
            v.[17] AS [V17],
            v.[18] AS [V18],
            v.[19] AS [V19],
            v.[20] AS [V20],
            v.[21] AS [V21],
            v.[22] AS [V22],
            v.[23] AS [V23],
            v.[24] AS [V24],
            v.[25] AS [V25],
            v.[26] AS [V26],
            v.[27] AS [V27],
            v.[28] AS [V28],
            v.[29] AS [V29],
            v.[30] AS [V30],
            v.[31] AS [V31],
            v.[32] AS [V32],
            v.[33] AS [V33],
            v.[34] AS [V34],
            v.[35] AS [V35],
            v.[36] AS [V36]
        FROM 
            TP_PERIODI_VENDUTO v
        INNER JOIN
            TP_STAGIONALE_PREVISIONI_STORICO p
        ON
            p.CodArticolo = v.CodArticolo and
            p.CodDeposito = v.CodDeposito
    ) BASE
) DATO1


GO
GRANT SELECT
    ON OBJECT::[dbo].[TP_VISTA_PERIODI_TRACKINGSIGNAL] TO [Metodo98]
    AS [dbo];

