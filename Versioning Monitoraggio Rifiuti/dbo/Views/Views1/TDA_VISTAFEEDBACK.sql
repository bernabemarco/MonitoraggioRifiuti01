create view TDA_VISTAFEEDBACK as
	select 
		TF.PROGRESSIVO,TF.TIPO,TF.STATO,
		DF1.DIPENDENTE,(select NOMECOMPLETO from TDA_VISTAOPERATORI OPE where OPE.CODICE=DF1.DIPENDENTE) as NOMEDIPENDENTE,
		DF1.ANNOBOLLA,DF1.NUMEROBOLLA,
		cast(DF1.ANNOBOLLA as varchar)+'/'+right('00000'+cast(DF1.NUMEROBOLLA as varchar),5) as RIFBOLLA,
		BOL.RIFORDINE,
		BOL.OPERAZIONE,BOL.DSCOPERAZIONE,
		BOL.CODCICLO,
		TF.CAUSALE,(select DESCRIZIONE from TDA_CAUSALIFEEDBACK CAU where CAU.CODICE=TF.CAUSALE) as DSCCAUSALE,
		DF1.GIUSTIFICATIVO,(select DESCRIZIONE from TDA_GIUSTIFICATIVI GIU where GIU.CODICE=DF1.GIUSTIFICATIVO) as DSCGIUSTIFICATIVO,
		TF.DATAMODIFICA as DATARILEVAZIONE
	from
		((TDA_FEEDBACK TF inner join TDA_DETTFEEDBACK_CONSUNTIVO DF1 on TF.PROGRESSIVO=DF1.RIFPROGRESSIVO)
		inner join VISTABOLLELAVORAZIONE BOL on DF1.ANNOBOLLA=BOL.ANNOBOLLA and DF1.NUMEROBOLLA=BOL.NUMEROBOLLA)

GO
GRANT SELECT
    ON OBJECT::[dbo].[TDA_VISTAFEEDBACK] TO [Metodo98]
    AS [dbo];

