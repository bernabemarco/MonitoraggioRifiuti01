

CREATE VIEW [dbo].[TP_VISTAAGENTI]
AS
    SELECT 
       ANAAGE.[CODAGENTE]
      ,ANAAGE.[DSCAGENTE]
      ,ANAAGE.[INDIRIZZO]
      ,ANAAGE.[CAP]
      ,ANAAGE.[LOCALITA]
      ,ANAAGE.[PROVINCIA]
      ,ANAAGE.[CODFISCALE]
      ,ANAAGE.[PROVVIGIONI]
      ,ANAAGE.[TELEFONO]
      ,ANAAGE.[FAX]
      ,ANAAGE.[TELEX]
      ,ANAAGE.[PARTITAIVA]
      ,ANAAGE.[NOTE]
      ,ANAAGE.[APPLPROVVRIGA]
      ,ANAAGE.[APPLPROVVFINALE]
      ,ANAAGE.[USAPRVPART]
      ,ANAAGE.[NOTE1]
      ,ANAAGE.[CODFOR]
      ,ANAAGE.[TIPOAGENZIA]
      ,ANAAGE.[TIPOSOCIETA]
      ,ANAAGE.[NRSOCI]
      ,ANAAGE.[NRMATRICOLAAGT]
      ,ANAAGE.[DATAISCRIZIONE]
      ,ANAAGE.[IMPORTOPREMIO]
      ,ANAAGE.[IMPORTOPREMIOEURO]
      ,ANAAGE.[NRFATTURA]
      ,ANAAGE.[DSCRIGAENAS]
      ,ANAAGE.[CDCOSTO]
      ,(CASE WHEN CNFAGE.CODAGENTE IS NULL THEN 'NO' ELSE 'SI' END) AS CONFIGURATO
      ,ISNULL(CNFAGE.ATTIVO,0) AS ATTIVO
      ,ISNULL(CNFAGE.TIPOEXPDATI,0) AS TIPOEXPDATI
    FROM 
        ANAGRAFICAAGENTI ANAAGE
    LEFT JOIN 
        TP_TRASFAGENTI CNFAGE
    ON 
        ANAAGE.CODAGENTE=CNFAGE.CODAGENTE


GO
GRANT SELECT
    ON OBJECT::[dbo].[TP_VISTAAGENTI] TO [Metodo98]
    AS [dbo];

