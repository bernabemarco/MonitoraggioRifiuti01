
CREATE VIEW FRCVistaDBContropartiteMancanti3 AS 
    SELECT *, ISNULL((SELECT PROVENIENZA FROM ANAGRAFICAARTICOLIPROD WHERE CODICEART = FRCVistaArticoliVB2.CODART AND ESERCIZIO = YEAR(GETDATE())), 0) AS PROVENIENZA
    FROM FRCVistaArticoliVB2 INNER JOIN FRCDistinteBasiEsplose
         ON FRCDistinteBasiEsplose.COMPOSTO = FRCVistaArticoliVB2.CODART AND FRCDistinteBasiEsplose.ANNO = FRCVistaArticoliVB2.ANNODOC
    WHERE ISNULL(FRCVistaArticoliVB2.GENCONTROP, '') = ''

GO
GRANT SELECT
    ON OBJECT::[dbo].[FRCVistaDBContropartiteMancanti3] TO [Metodo98]
    AS [dbo];

