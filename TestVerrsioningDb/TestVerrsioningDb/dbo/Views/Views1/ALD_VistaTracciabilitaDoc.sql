
CREATE VIEW ALD_VistaTracciabilitaDoc AS
SELECT     RIGHEDOCUMENTI.IDTESTA, MAX(RIGHEDOCUMENTI.IDTESTARP) as IdTestaRP
FROM         RIGHEDOCUMENTI INNER JOIN
                      TESTEDOCUMENTI ON RIGHEDOCUMENTI.IDTESTARP = TESTEDOCUMENTI.PROGRESSIVO
WHERE     (RIGHEDOCUMENTI.TIPORIGA in ('N','D'))
GROUP BY RIGHEDOCUMENTI.IDTESTA
HAVING      (MAX(RIGHEDOCUMENTI.IDTESTARP) <> 0)


GO
GRANT SELECT
    ON OBJECT::[dbo].[ALD_VistaTracciabilitaDoc] TO [Metodo98]
    AS [dbo];

