CREATE VIEW [dbo].[ORDPRODPLANCOMM] AS
SELECT RPD.RifCommCli,CAST(TP.ESERCIZIO AS VARCHAR(4)) + '/' + TP.TIPOCOM + '/' + RIGHT('00000000'+ CAST(TP.NUMEROCOM AS VARCHAR(8)),8) + '/' + RPD.CODICEORD + RIGHT('0000'+ CAST(RPD.POSIZIONE AS VARCHAR(4)),4) AS ORDINI ,
  RPD.DATAEMISSIONE, RPD.DATAINIZIORICH, RPD.DATAFINERICH
FROM RIGHEORDPROD as RPD INNER JOIN TESTEORDINIPROD  TP ON RPD.IDTESTA = TP.PROGRESSIVO


GO
GRANT SELECT
    ON OBJECT::[dbo].[ORDPRODPLANCOMM] TO [Metodo98]
    AS [dbo];

