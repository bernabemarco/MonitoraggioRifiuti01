CREATE VIEW TP_VISTADOCUMENTIAGENTI
AS
SELECT SUM(RIGHEDOCUMENTI.TOTNETTORIGAEURO*TESTEDOCUMENTI.SEGNO) AS ImponibileAgente,
                       TESTEDOCUMENTI.CODAGENTE1, 
         MONTH(TESTEDOCUMENTI.DATADOC) AS Mese
FROM TESTEDOCUMENTI  INNER JOIN RIGHEDOCUMENTI ON   TESTEDOCUMENTI.PROGRESSIVO=RIGHEDOCUMENTI.IDTESTA  
WHERE (TESTEDOCUMENTI.tipodoc = 'FAT' OR
 TESTEDOCUMENTI.Tipodoc = 'NCC') AND YEAR(TESTEDOCUMENTI.DataDoc) = YEAR(GETDATE()) AND 
 TESTEDOCUMENTI.CodAgente1 >= 'A     1' AND TESTEDOCUMENTI.CodAgente1 <= 'A999999'
GROUP BY TESTEDOCUMENTI.codagente1, MONTH(TESTEDOCUMENTI.DataDoc)




GO
GRANT DELETE
    ON OBJECT::[dbo].[TP_VISTADOCUMENTIAGENTI] TO [Metodo98]
    AS [dbo];


GO
GRANT INSERT
    ON OBJECT::[dbo].[TP_VISTADOCUMENTIAGENTI] TO [Metodo98]
    AS [dbo];


GO
GRANT REFERENCES
    ON OBJECT::[dbo].[TP_VISTADOCUMENTIAGENTI] TO [Metodo98]
    AS [dbo];


GO
GRANT SELECT
    ON OBJECT::[dbo].[TP_VISTADOCUMENTIAGENTI] TO [Metodo98]
    AS [dbo];


GO
GRANT UPDATE
    ON OBJECT::[dbo].[TP_VISTADOCUMENTIAGENTI] TO [Metodo98]
    AS [dbo];

