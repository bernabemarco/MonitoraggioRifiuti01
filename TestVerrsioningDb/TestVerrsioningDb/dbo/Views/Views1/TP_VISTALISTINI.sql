
/****** Oggetto: vista dbo.TP_VISTALISTINI    Data dello script: 26/04/2005 16.16.30 ******/
CREATE VIEW TP_VISTALISTINI
AS
SELECT	LISTINIARTICOLI.*, 
		TABLISTINI.DESCRIZIONE, 
	TABLISTINI.CODCAMBIO, 
	TABCAMBI.DIVISA, 
	TABCAMBI.DESCRIZIONE AS DESCRDIVISA, 
	TABLISTINI.VINCOLAUM, 
	CASE TABLISTINI.TP_Tipo 
		WHEN 'V' THEN 'Vendita' 
		WHEN 'A' THEN 'Acquisto' 
		WHEN 'N' THEN 'Valutazione' 
		ELSE 'Libero' 
	END AS TIPO
FROM		TABLISTINI,LISTINIARTICOLI,TABCAMBI
WHERE	TABLISTINI.CODCAMBIO=TABCAMBI.CODICE
		AND LISTINIARTICOLI.NRLISTINO=TABLISTINI.NRLISTINO


GO
GRANT DELETE
    ON OBJECT::[dbo].[TP_VISTALISTINI] TO [Metodo98]
    AS [dbo];


GO
GRANT INSERT
    ON OBJECT::[dbo].[TP_VISTALISTINI] TO [Metodo98]
    AS [dbo];


GO
GRANT REFERENCES
    ON OBJECT::[dbo].[TP_VISTALISTINI] TO [Metodo98]
    AS [dbo];


GO
GRANT SELECT
    ON OBJECT::[dbo].[TP_VISTALISTINI] TO [Metodo98]
    AS [dbo];


GO
GRANT UPDATE
    ON OBJECT::[dbo].[TP_VISTALISTINI] TO [Metodo98]
    AS [dbo];

