create view [VISTAPREZZITERZISTA] as
select 
	CF.CODCONTO,ART.CODICE as ARTICOLO,
	isnull(LST.NRLISTINO,0) as LISTINO,
	isnull(LST.UM,'') as UMLISTINO,
	isnull(LST.PREZZOEURO,0) as PREZZOLISTINO,
	isnull(STP.UM,'') as UMULTPREZZO,
	isnull(STP.PREZZOEURO,0) as ULTPREZZO
from ANAGRAFICAARTICOLI ART
	left outer join ANAGRAFICACF CF on CF.TIPOCONTO='F'
	left outer join TABLISTINIFORTRASF LSF on LSF.CODFOR=CF.CODCONTO
	left outer join LISTINIARTICOLITRASF LST on LST.NRLISTINO=LSF.NRLISTINO and LST.CODART=ART.CODICE and LST.CODOPERAZIONE='0'
	left outer join STORICOPREZZIARTICOLO STP on STP.TIPOPREZZO='F' and STP.ULTIMO=1 and STP.CODCLIFOR=CF.CODCONTO and STP.CODARTICOLO=ART.CODICE

GO
GRANT SELECT
    ON OBJECT::[dbo].[VISTAPREZZITERZISTA] TO [Metodo98]
    AS [dbo];

