CREATE VIEW VISTAORDINICLA AS
SELECT
	TPR.ESERCIZIO AS ESERCIZIOPROD,
	TPR.TIPOCOM,
	TPR.NUMEROCOM,
	ROP.IDTESTA AS IDTESTACLA,
	ROP.IDRIGA AS IDRIGACLA,
	ROP.CODICEORD,
	ROP.QTAGESTIONE AS QTAORDINE,
	ROP.UMGEST AS UMORDINE,
	IOP.CODART AS ARTICOLOCOMP,
	IOP.DESCRIZIONEART AS DESCRCOMP,
	IOP.QTAGESTIONE AS QTAIMPEGNATA,
	IOP.UMGEST AS UMIMPEGNO,
	PIOP.PARTITA AS CODPARTITA,
	PIOP.QTAGESTIONE AS QTAIMPPARTITA,
	TD.TIPODOC,
	TD.ESERCIZIO,
	TD.NUMERODOC,
	TD.NUMRIFDOC,
	TD.DATARIFDOC	
FROM
	TesteOrdiniProd TPR inner join
	(RigheOrdProd ROP inner join 
	(ImpegniOrdProd IOP left outer join
	(PartiteImpegniOrdProd PIOP left outer join 
	TesteDocumenti TD on PIOP.IDTestaDoc=TD.Progressivo)
	on IOP.IDTesta=PIOP.IDTesta and IOP.IDRiga=PIOP.IDRiga 
	and IOP.IDImpegno=PIOP.IDImpegno)
	on ROP.IDTesta=IOP.IDTesta and ROP.IDRiga=IOP.IDRiga)
	on TPR.Progressivo=ROP.IDTesta

GO
GRANT SELECT
    ON OBJECT::[dbo].[VISTAORDINICLA] TO [Metodo98]
    AS [dbo];

