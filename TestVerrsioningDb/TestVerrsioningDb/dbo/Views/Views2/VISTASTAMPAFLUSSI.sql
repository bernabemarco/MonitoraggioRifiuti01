


/*-------------------------------------------------
--   Create views
-------------------------------------------------*/


create view VISTASTAMPAFLUSSI
  as select TF.*,RF.IDLIVELLO,RF.IDLIVPADRE,RF.IMPORTO,RF.POSIZIONE,RF.TIPORICLASS,RF.DESCRIZIONE as DSCLIVELLO,RF.STAMPALIVELLO as STPLIVELLO,
    (select LIVELLO from RIGHESCHEMARICL where IDSCHEMA = TF.IDSCHEMA and IDLIVELLO = RF.IDLIVELLO and TIPORICLASS = RF.TIPORICLASS) as LIVELLO,
    (select NOMESCHEMA from TESTESCHEMARICL where IDSCHEMA = TF.IDSCHEMA) as NOMESCHEMA,
    (select DESCRIZIONE from TESTECOLLEGRICL where IDCOLLEGAMENTO = TF.IDCOLLEGAMENTO) as DSCCOLLEGAMENTO from
    TESTEFLUSSIRICL TF,RIGHEFLUSSIRICL RF where TF.IDFLUSSO = RF.IDFLUSSO

GO
GRANT SELECT
    ON OBJECT::[dbo].[VISTASTAMPAFLUSSI] TO [AnaBilancio]
    AS [dbo];

